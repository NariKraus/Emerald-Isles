<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>Emerald Isles - Plots</title>
    <meta content="" name="description">
    <meta content="" name="keywords">
    <base href="https://narikraus.github.io/Emerald-Isles/" target="_self">

    <!-- Favicons -->
    <link href="assets/img/favicon.png" rel="icon">
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">

    <!-- Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet">

</head>

<body>

    <!-- ======= Header ======= -->
    <header id="header" class="d-flex align-items-center">
    </header><!-- End Header -->

    <main id="main">

        <!-- ======= Breadcrumbs ======= -->
        <section id="breadcrumbs" class="breadcrumbs">
            <div class="container">

                <ol>
                    <li>Game Master</li>
                    <li>Plots</li>
                </ol>
                <h2>Plots</h2>

            </div>
        </section><!-- End Breadcrumbs -->

        <section data-aos="zoom out" data-aos-duration="250" class="plots">
            <div class="container">
                <div class="row">

                </div>
            </div>
        </section>

        <section>
            <div class="row">
                <div class="mx-auto col-lg-6">
                    <div class="form">
                        <div class="row">
                            <div class="col-md-12 form-group">
                                <input type="text" name="plot-title" class="form-control" id="plot-title" placeholder="Plot Title" required="">
                            </div>
                            <div class="col-md-6 form-group mt-3">
                                <input type="text" class="form-control" name="plot-subtitle" id="plot-subtitle" placeholder="Plot Subtitle" required="">
                            </div>
                            <div class="col-md-6 form-group mt-3">
                                <input type="text" class="form-control" name="plot-catagory" id="plot-catagory" placeholder="Plot Catagory" required="">
                            </div>
                        </div>
                        <div class="form-group my-3">
                            <textarea class="form-control" name="plot-description" id="plot-description" rows="5" placeholder="Plot Description" required=""></textarea>
                        </div>
                        <div class="text-center"><button class="btn btn-outline-dark text-light" type="submit">Save Plot</button></div>
                    </div>
                </div>
            </div>
        </section>

    </main><!-- End #main -->

    <!-- ======= Footer ======= -->
    <footer id="footer">
    </footer><!-- End Footer -->

    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
    <div id="preloader"></div>

    <!-- Main JS File -->
    <script src="assets/js/main.js"></script>

    <!-- Vendor JS Files -->
    <script src="assets/vendor/aos/aos.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
    <script src="assets/vendor/jquery/jquery.min.js"></script>
    <script src="assets/vendor/jquery-sticky/jquery.sticky.js"></script>
    <script src="assets/vendor/jquery.easing/jquery.easing.min.js"></script>

    <!-- Navbar Loader -->
    <script src="assets/js/navbar-loader.js"></script>

    <script>
        $('.row:first').load('/Emerald-Isles/assets/html/plots.html');

        $(document).ready(function() {
            var setCollapse = function () {
                for (let i = 0; i < $('.list-group-item').length; i++) {
                    const element = $('.list-group-item')[i];
                    $(element).find('.plot-title').attr('data-bs-target', '#plot-' + i);
                    $(element).find('.plot-title').attr('aria-controls', 'plot-' + i);
                    $(element).find('.collapse').attr('id', 'plot-' + i);
                };
            };
    
            setCollapse()

            var setTimes = function () {
                for (let i = 0; i < $('.list-group-item').length; i++) {
                    const element = $('.list-group-item')[i];
    
                    const date = $(element).find('.date').attr('title');
                    const day_start = new Date(date);
                    const day_end = new Date();
    
                    // get total seconds between the times
                    var delta = Math.abs(day_end - day_start) / 1000;
    
                    // calculate (and subtract) whole days
                    const years = Math.floor(delta / 31536000);
                    delta -= years * 31536000;
    
                    // calculate (and subtract) whole days
                    const months = Math.floor(delta / 2592000);
                    delta -= months * 2592000;
    
                    // calculate (and subtract) whole days
                    const days = Math.floor(delta / 86400);
                    delta -= days * 86400;
    
                    // calculate (and subtract) whole hours
                    const hours = Math.floor(delta / 3600) % 24;
                    delta -= hours * 3600;
    
                    // calculate (and subtract) whole minutes
                    const minutes = Math.floor(delta / 60) % 60;
                    delta -= minutes * 60;
    
                    if (years > 1) {
                        $(element).find('.date').html(years + ' years ago');
                    }
                    else if (years == 1) {
                        $(element).find('.date').html('1 year ago');
                    }
                    else if (months > 1) {
                        $(element).find('.date').html(months + ' months ago');
                    }
                    else if (months == 1) {
                        $(element).find('.date').html('1 month ago');
                    }
                    else if (days > 1) {
                        $(element).find('.date').html(days + ' days ago');
                    }
                    else if (days == 1) {
                        $(element).find('.date').html('1 day ago');
                    }
                    else if (hours > 1) {
                        $(element).find('.date').html(hours + ' hours ago');
                    }
                    else if (hours == 1) {
                        $(element).find('.date').html('1 hour ago');
                    }
                    else if (minutes > 1) {
                        $(element).find('.date').html(minutes + ' minutes ago');
                    }
                    else if (minutes == 1) {
                        $(element).find('.date').html('1 minute ago');
                    }
                    else {
                        $(element).find('.date').html('Now');
                    }
                };
            };

            setTimeout(function() {
                setTimes()
            }, 250);

            var now = new Date();
            var millisTill10 = new Date(now.getFullYear(), now.getMonth(), now.getDate(), now.getHours(), now.getMinutes() + 1, 0, 0) - now;
            setTimeout(function minutePassed() {
                var now = new Date();
                var millisTill10 = new Date(now.getFullYear(), now.getMonth(), now.getDate(), now.getHours(), now.getMinutes() + 1, 0, 0) - now;
                setTimes();
                setTimeout(minutePassed, millisTill10);
            }, millisTill10);
    
            months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
    
            $('.form').on('click', 'button[type=submit]', function () {
                date = new Date();
                var $title = $('#plot-title');
                var $subtitle = $('#plot-subtitle');
                var $desc = $('#plot-description');
                var $catagory = $('#plot-catagory');
    
                var title = $title.val();
                var subtitle = $subtitle.val();
                var desc = $desc.val();
                var catagory = '#' + $catagory.val();
    
                desc = desc.replace(/\n/g, `</div><div class="text-muted small mb-2">`);
    
                var newElement = `<li id="` + title.toLowerCase().replace(/ /g, '-') + `" class="list-group-item bg-dark text-light"><div data-bs-toggle="collapse" role="button" aria-expanded="false" class="plot-title"><div class="d-flex w-100 justify-content-between"><h5 class="mb-1">` + title + `</h5><div class="text-muted small date" title="` + months[date.getMonth()] + ' ' + date.getDate() + ' ' + date.getFullYear() + ', ' + date.getHours() + ':' + date.getMinutes() + `"></div></div><p class="mb-1">` + subtitle + `</p></div><div class="collapse"><div class="text-muted small mb-2">` + desc + `</div></div></li>`;
    
                if ( $(catagory).length == 0 ) {
                    $('div.row:first').append('<div id="' + catagory.substring(1) + '"></div>');
                    $(catagory).append('<div class="title">' + catagory.substring(1).toUpperCase() + '</div>');
                    $(catagory).append('<ul class="list-group p-2 mb-5"></ul>');  
                };
    
                $(catagory).find('.list-group').append(newElement);
    
                setCollapse();
            });
    
    
    
            $('#breadcrumbs').find('h2').on('click', function() {
                let selectedPlot = prompt("Please enter a plot title", "");
                if (selectedPlot != null && selectedPlot != "") {
                    selectedPlot = selectedPlot.toLowerCase().replace(/ /g, '-');
                    const selected = '#' + selectedPlot;
                    console.log($(selected).prop('outerHTML'));
                };
            });
        });
    </script>

</body>

</html>