<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>Emerald Isles - Plots</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="assets/img/favicon.png" rel="icon">
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

    <!-- Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet">

</head>

<body>

    <!-- ======= Header ======= -->
    <header id="header" class="d-flex align-items-center">
        <div class="container d-flex align-items-center justify-content-between">
            <h1 class="logo"><a href="index.html">Emerald Isles</a></h1>
            <nav id="navbar" class="navbar">
                <ul>
                    <li><a class="nav-link" href="index.html">Home</a></li>
                    <li class="dropdown"><a class="nav-link" href="states.html">States<i class="bi bi-chevron-down"></i></a>
                        <ul>
                            <li><a class="nav-link" href="states-bothamia.html">Bothamia</a></li>
                            <li><a class="nav-link" href="states-cal'en.html">Cal'en</a></li>
                            <li><a class="nav-link" href="states-godminia.html">Godminia</a></li>
                            <li><a class="nav-link" href="states-khundus.html">Khundus</a></li>
                            <li><a class="nav-link" href="states-nakara.html">Nakara</a></li>
                            <li><a class="nav-link" href="states-sorasene.html">Sorasene</a></li>
                            <li><a class="nav-link" href="states-syran.html">Syran</a></li>
                        </ul>
                    </li>
                    <li class="dropdown"><a class="nav-link">Utilities <i class="bi bi-chevron-down"></i></a>
                        <ul>
                            <li><a class="nav-link" href="utilities-playable-races.html">Races</a></li>
                            <li><a class="nav-link" href="utilities-pantheon.html">Pantheon</a></li>
                            <div class="break"></div>
                            <li><a class="nav-link" href="utilities-custom-items.html">Items & Materials</a></li>
                            <li><a class="nav-link" href="utilities-npcs.html">NPCs</a></li>
                            <div class="break"></div>
                            <li class="dropdown"><a class="nav-link" href="utilities-optional-rules.html">Optional Rules <i class="bi bi-chevron-down"></i></a>
                                <ul>
                                    <li><a class="nav-link" href="utilities-optional-rules.html#shield-variants">Shield Variants <i class="bi bi-question-circle-fill" style="color: var(--bs-warning);"></i></a></li>
                                    <li><a class="nav-link" href="utilities-optional-rules.html#weapon-properties">Weapon Properties <i class="bi bi-hand-thumbs-up-fill" style="color: var(--bs-success);"></i></a></li>
                                    <li><a class="nav-link" href="utilities-optional-rules.html#gritty-realism">Gritty Realism <i class="bi bi-question-circle-fill" style="color: var(--bs-warning);"></i></a></li>
                                    <li><a class="nav-link" href="utilities-optional-rules.html#underwater-combat">Underwater Combat <i class="bi bi-question-circle-fill" style="color: var(--bs-warning);"></i></a></li>
                                    <li><a class="nav-link" href="utilities-optional-rules.html#lingering-injuries">Lingering Injuries <i class="bi bi-hand-thumbs-up-fill" style="color: var(--bs-success);"></i></a></li>
                                    <li><a class="nav-link" href="utilities-optional-rules.html#lifestyle-expenses">Lifestyle Expenses <i class="bi bi-question-circle-fill" style="color: var(--bs-warning);"></i></a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="dropdown"><a class="nav-link" href="players.html">Players <i class="bi bi-chevron-down"></i></a>
                        <ul>
                            <li><a class="nav-link" href="players.html">Players</a></li>
                            <li><a class="nav-link" href="point-buy.html">Point Buy</a></li>
                        </ul>
                    </li>
                    <li class="dropdown"><a hidden class="nav-link">Game Master <i class="bi bi-chevron-down"></i></a>
                        <ul>
                            <li><a class="nav-link" href="dm-plots.html">Plots</a></li>
                            <div class="break"></div>
                            <li><a class="nav-link" href="dm-statblocks.html">Stat Blocks</a></li>
                        </ul>
                    </li>
                </ul>
                <i class="bi bi-list mobile-nav-toggle"></i>
            </nav>
        </div>
    </header><!-- End Header -->

    <main id="main">

        <!-- ======= Breadcrumbs ======= -->
        <section id="breadcrumbs" class="breadcrumbs">
            <div class="container">

                <ol>
                    <li>Game Master</li>
                    <li>Plots</li>
                </ol>
                <h2>Plots</h2>

            </div>
        </section><!-- End Breadcrumbs -->

        <section data-aos="zoom out" data-aos-duration="250" class="plots">
            <div class="container">
                <div class="row">

                </div>
            </div>
        </section>

        <section>
            <div class="row">
                <div class="mx-auto col-lg-6">
                    <div class="form">
                        <div class="row">
                            <div class="col-md-12 form-group">
                                <input type="text" name="plot-title" class="form-control" id="plot-title" placeholder="Plot Title" required="">
                            </div>
                            <div class="col-md-6 form-group mt-3">
                                <input type="text" class="form-control" name="plot-subtitle" id="plot-subtitle" placeholder="Plot Subtitle" required="">
                            </div>
                            <div class="col-md-6 form-group mt-3">
                                <input type="text" class="form-control" name="plot-catagory" id="plot-catagory" placeholder="Plot Catagory" required="">
                            </div>
                        </div>
                        <div class="form-group my-3">
                            <textarea class="form-control" name="plot-description" id="plot-description" rows="5" placeholder="Plot Description" required=""></textarea>
                        </div>
                        <div class="text-center"><button class="btn btn-outline-dark text-light" type="submit">Save Plot</button></div>
                    </div>
                </div>
            </div>
        </section>

    </main><!-- End #main -->

    <!-- ======= Footer ======= -->
    <footer id="footer" class="footer" style="height: 106.5px;">
    </footer><!-- End Footer -->

    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
    <div id="preloader"></div>

    <!-- Vendor JS Files -->
    <script src="assets/vendor/aos/aos.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
    <script src="assets/vendor/jquery/jquery.min.js"></script>
    <script src="assets/vendor/jquery-sticky/jquery.sticky.js"></script>
    <script src="assets/vendor/jquery.easing/jquery.easing.min.js"></script>

    <!-- Main JS File -->
    <script src="assets/js/main.js"></script>
    <script>
        let params = (new URL(document.location)).searchParams;
        let DM = params.get('DM');
        if (DM == 'true') {
            $('.nav-link:hidden').attr('hidden', false);
            for (let i = 0; i < $('a[href]').length; i++) {
                const x = $('a[href]')[i];
                $(x).attr("href", function(i, href) {
                    return href + '?DM=true';
                });
            };
        };
    </script>

    <script>
        var jsonPlots = (function () {
            var jsonPlots = null;
            $.ajax({
                'async': false,
                'global': false,
                'url': 'data/plots.json',
                'dataType': "json",
                'success': function (data) {
                    jsonPlots = data;
                }
            });
            return jsonPlots;
        })();

        jQuery.each(jsonPlots.plots, function(i, val) {

            $('div.row:first').append('<div id="' + i.toLowerCase() + '"></div>');
            const x = '#' + i.toLowerCase();
            $(x).append('<div class="title">' + i + '</div>');
            $(x).append('<ul class="list-group p-2 mb-5"></ul>');

            for (let i = 0; i < val.length; i++) {
                $(x).find('.list-group').append(val[i][i]);
            };

        });
    </script>

    <script>
        for (let i = 0; i < $('.list-group-item').length; i++) {
            const element = $('.list-group-item')[i];

            const date = $(element).find('.date').attr('title');
            const day_start = new Date(date);
            const day_end = new Date();

            // get total seconds between the times
            var delta = Math.abs(day_end - day_start) / 1000;

            // calculate (and subtract) whole days
            const years = Math.floor(delta / 31536000);
            delta -= years * 31536000;

            // calculate (and subtract) whole days
            const months = Math.floor(delta / 2592000);
            delta -= months * 2592000;

            // calculate (and subtract) whole days
            const days = Math.floor(delta / 86400);
            delta -= days * 86400;

            // calculate (and subtract) whole hours
            const hours = Math.floor(delta / 3600) % 24;
            delta -= hours * 3600;

            // calculate (and subtract) whole minutes
            const minutes = Math.floor(delta / 60) % 60;
            delta -= minutes * 60;

            if (years > 1) {
                $(element).find('.date').html(years + ' years ago');
            }
            else if (years == 1) {
                $(element).find('.date').html('1 year ago');
            }
            else if (months > 1) {
                $(element).find('.date').html(months + ' months ago');
            }
            else if (months == 1) {
                $(element).find('.date').html('1 month ago');
            }
            else if (days > 1) {
                $(element).find('.date').html(days + ' days ago');
            }
            else if (days == 1) {
                $(element).find('.date').html('1 day ago');
            }
            else if (hours > 1) {
                $(element).find('.date').html(hours + ' hours ago');
            }
            else if (hours == 1) {
                $(element).find('.date').html('1 hour ago');
            }
            else if (minutes > 1) {
                $(element).find('.date').html(minutes + ' minutes ago');
            }
            else if (minutes == 1) {
                $(element).find('.date').html('1 minute ago');
            }
            else {
                $(element).find('.date').html('Now');
            }
        };
    </script>

    <script>
        var setCollapse = function () {
            for (let i = 0; i < $('.list-group-item').length; i++) {
                const element = $('.list-group-item')[i];
                $(element).find('.plot-title').attr('data-bs-target', '#plot-' + i);
                $(element).find('.plot-title').attr('aria-controls', 'plot-' + i);
                $(element).find('.collapse').attr('id', 'plot-' + i);
            };
        };

        setCollapse()
    </script>

    <script>
        months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];

        $('.form').on('click', 'button[type=submit]', function () {
            date = new Date();
            var $title = $('#plot-title');
            var $subtitle = $('#plot-subtitle');
            var $desc = $('#plot-description');
            var $catagory = $('#plot-catagory');

            var title = $title.val();
            var subtitle = $subtitle.val();
            var desc = $desc.val();
            var catagory = '#' + $catagory.val();

            desc = desc.replace(/\n/g, `</div><div class="text-muted small mb-2">`);

            var newElement = `<li class="list-group-item bg-dark text-light"><div data-bs-toggle="collapse" role="button" aria-expanded="false" class="plot-title"><div class="d-flex w-100 justify-content-between"><h5 class="mb-1">` + title + `</h5><div class="text-muted small date" title="` + months[date.getMonth()] + ' ' + date.getDate() + ' ' + date.getFullYear() + ', ' + date.getHours() + ':' + date.getMinutes() + `"></div></div><p class="mb-1">` + subtitle + `</p></div><div class="collapse"><div class="text-muted small mb-2">` + desc + `</div></div></li>`;

            $(catagory).find('.list-group').append(newElement);

            console.log( $(newElement) );

            setCollapse();
        });
    </script>

</body>

</html>